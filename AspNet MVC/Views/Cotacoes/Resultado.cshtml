@model Models.ViewModel.CotacaoResultadoViewModel

@{
    ViewData["Title"] = "Resultados da Cotação";
}

<h2 class="mb-3">Resultados da Cotação</h2>

<div class="mb-3">
    <strong>Cotação:</strong> @Model.DescricaoCotacao <br />
    <strong>Data limite:</strong> @Model.DataFechamento.ToString("dd/MM/yyyy")
</div>

@if (Model.Fornecedores == null || !Model.Fornecedores.Any())
{
    <div class="alert alert-warning">
        Nenhuma proposta foi registrada para esta cotação.
    </div>
}
else
{
    var top3 = Model.Fornecedores.Take(3).ToList();

    <h4 class="mb-3">Top 3 menores orçamentos</h4>

    <div class="card shadow-sm mb-4">
        <div class="card-body p-0">
            <table class="table table-striped table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>#</th>
                        <th>Fornecedor</th>
                        <th class="text-end">Valor Total</th>
                    </tr>
                </thead>
                <tbody>
                @for (int i = 0; i < top3.Count; i++)
                {
                    var r = top3[i];
                    <tr>
                        <td>@(i + 1)</td>
                        <td>@r.FornecedorNome</td>
                        <td class="text-end">R$ @r.ValorTotal.ToString("N2")</td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
    </div>

    <h4 class="mb-3">Todas as propostas</h4>

    <div class="card shadow-sm">
        <div class="card-body p-0">
            <table class="table table-striped table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Fornecedor</th>
                        <th class="text-end">Valor Total</th>
                    </tr>
                </thead>
                <tbody>
                @foreach (var r in Model.Fornecedores)
                {
                    <tr>
                        <td>@r.FornecedorNome</td>
                        <td class="text-end">R$ @r.ValorTotal.ToString("N2")</td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
    </div>
}

<div class="mt-3">
    <a asp-action="Index" class="btn btn-outline-secondary">Voltar</a>
</div>
